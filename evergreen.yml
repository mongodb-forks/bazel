functions:
  "fetch source" :
    - command: git.get_project
      params:
        directory: src
  
tasks:
- name: compile
  depends_on: []
  commands:
    - func: "fetch source"
    - command: shell.exec
      working_dir: src
      params:
        script: |
          /opt/mongodbtoolchain/v4/bin/python3 -m virtualenv venv
          ./venv/bin/activate
          python3 -m pip install docker
          python3 src/mongo_linux_build.py
          ./mongo_bazel --version

buildvariants:

- name: ubuntu2004
  display_name: Ubuntu 20.04
  run_on:
  - ubuntu2204-large
  tasks:
  - name: compile